import{f as R,q as S}from"./vendor-1e70d1e5.js";import{T as I,B as U}from"./TableAction-859c4e98.js";import{_ as L}from"./index-5b101bf5.js";import{A as P,B as $,e as q,u as z}from"./index-5c1076ad.js";import"./index-20ae1759.js";import"./useDesignSetting-4e44141c.js";function M(o){const a=Vue.ref(!1),c=Vue.ref(null),l=Vue.ref(null);return{loading:a,error:l,result:c,fetchResource:p=>(a.value=!0,o(p).then(m=>{c.value=m}).catch(m=>{l.value=m}).finally(()=>{a.value=!1}))}}function K(){const{loading:o,error:a,result:c,fetchResource:l}=M(P);return{loading:o,error:a,list:c,fetchResource:l}}const O=[{title:"id",key:"id",width:50},{title:"名称",key:"name",width:100},{title:"secret",key:"secret",width:200},{title:"创建时间",key:"createtime",width:200},{title:"状态",key:"online",width:100,render(o){return Vue.h(naive.NTag,{style:{marginRight:"6px"},type:o.online==1?"success":"error",bordered:!1},{default:()=>o.online==1?"在线":"离线"})}}],j=Vue.createTextVNode(" 新建 "),G=Vue.createTextVNode("取消"),H=Vue.createTextVNode("确定"),ee=Vue.defineComponent({__name:"index",setup(o){const a={name:{required:!0,trigger:["blur","input"],message:"请输入名称"}},c=naive.useDialog(),l=Vue.ref(null),r=naive.useMessage(),p=Vue.ref(),m=R(),s=Vue.ref(!1),v=Vue.ref(!1),u=Vue.reactive({name:"",resetSecret:!1}),d=Vue.ref(""),V=Vue.ref({id:"",name:"",mail:"",secret:""}),C=Vue.ref([]),B=Vue.reactive({width:200,title:"操作",key:"action",render(e){return Vue.h(I,{style:"button",actions:[{label:"详情",type:"primary",disabled:e.online!=1,onClick:b.bind(null,e)},{label:"编辑",type:"primary",onClick:y.bind(null,e),ifShow:()=>!0},{label:"删除",type:"error",icon:"ic:outline-delete-outline",onClick:x.bind(null,e),ifShow:()=>!0}],select:t=>{r.info(`您点击了，${t} 按钮`)}})}});function k(){u.name="",d.value="新建实例",s.value=!0}async function _(){const{list:n,error:f,fetchResource:h}=K();await h({pagesize:0,pageno:0}),f.value?r.info(`error--${f.value}`):C.value=n.value.data.list}function w(e){console.log(e)}function g(e){e.preventDefault(),v.value=!0,l.value.validate(t=>{if(t)r.error("请填写完整信息");else if(d.value=="新建实例"){const n=u.name;q({name:n}).then(()=>{r.success("新建成功"),s.value=!1,_()})}else if(d.value=="编辑实例"){const n=V.value.id;z({id:n,...u}).then(()=>{r.success("编辑成功"),s.value=!1,_()})}v.value=!1})}function y(e){u.name=e.name,d.value="编辑实例",s.value=!0,V.value.id=e.id,V.value.name=e.name,V.value.mail=localStorage.getItem("mail")||""}function b(e){const t=e.id,n=m.resolve({name:"instance_dashboard",params:{id:t}});window.open(n.href,"_blank")}function x(e){c.info({title:"提示",content:"您确定要删除此实例吗",positiveText:"确定",negativeText:"取消",onPositiveClick:()=>{$({id:e.id}).then(()=>{r.success("删除成功")})},onNegativeClick:()=>{}})}return(e,t)=>{const n=Vue.resolveComponent("n-icon"),f=Vue.resolveComponent("n-button"),h=Vue.resolveComponent("n-input"),F=Vue.resolveComponent("n-form-item"),E=Vue.resolveComponent("n-checkbox"),N=Vue.resolveComponent("n-form"),D=Vue.resolveComponent("n-space"),A=Vue.resolveComponent("n-modal"),T=Vue.resolveComponent("n-card");return Vue.openBlock(),Vue.createElementBlock("div",null,[Vue.createVNode(Vue.unref(L),{onTick:_}),Vue.createVNode(T,{bordered:!1,class:"proCard"},{default:Vue.withCtx(()=>[Vue.createVNode(Vue.unref(U),{columns:Vue.unref(O),dataSource:C.value,"row-key":i=>i.id,pagination:!1,ref_key:"actionRef",ref:p,actionColumn:B,"onUpdate:checkedRowKeys":w,"scroll-x":1090},{tableTitle:Vue.withCtx(()=>[Vue.createVNode(f,{type:"primary",onClick:k},{icon:Vue.withCtx(()=>[Vue.createVNode(n,null,{default:Vue.withCtx(()=>[Vue.createVNode(Vue.unref(S))]),_:1})]),default:Vue.withCtx(()=>[j]),_:1})]),_:1},8,["columns","dataSource","row-key","actionColumn"]),Vue.createVNode(A,{show:s.value,"onUpdate:show":t[3]||(t[3]=i=>s.value=i),"show-icon":!1,preset:"dialog",title:d.value},{action:Vue.withCtx(()=>[Vue.createVNode(D,null,{default:Vue.withCtx(()=>[Vue.createVNode(f,{onClick:t[2]||(t[2]=()=>s.value=!1)},{default:Vue.withCtx(()=>[G]),_:1}),Vue.createVNode(f,{type:"info",loading:v.value,onClick:g},{default:Vue.withCtx(()=>[H]),_:1},8,["loading"])]),_:1})]),default:Vue.withCtx(()=>[Vue.createVNode(N,{model:u,rules:a,ref_key:"formRef",ref:l,"label-placement":"left","label-width":85,class:"py-4"},{default:Vue.withCtx(()=>[Vue.createVNode(F,{label:"名称",path:"name"},{default:Vue.withCtx(()=>[Vue.createVNode(h,{placeholder:"请输入实例名称",value:u.name,"onUpdate:value":t[0]||(t[0]=i=>u.name=i)},null,8,["value"])]),_:1}),d.value=="编辑实例"?(Vue.openBlock(),Vue.createBlock(F,{key:0,label:"重置 secret",path:"resetSecret"},{default:Vue.withCtx(()=>[Vue.createVNode(E,{checked:u.resetSecret,"onUpdate:checked":t[1]||(t[1]=i=>u.resetSecret=i)},null,8,["checked"])]),_:1})):Vue.createCommentVNode("",!0)]),_:1},8,["model"])]),_:1},8,["show","title"])]),_:1})])}}});export{ee as default};
