import{g as e,i as t}from"./vendor-2e943313.js";import{T as a,B as o}from"./TableAction-c17a6634.js";import{d as n,e as u,u as l}from"./index-8caa8cc3.js";import{_ as r}from"./index-dbd922fe.js";import"./useDesignSetting-a0c3f2ea.js";const i=[{title:"名称",render:e=>!1===e.RawConfig.enabled?Vue.h("div",[Vue.h("text",e.Name),Vue.h(naive.NTag,{type:"primary"},"禁用")]):Vue.h("text",e.Name),width:100},{title:"版本",key:"Version",width:200}],s=Vue.createTextVNode("取消"),c=Vue.createTextVNode("确定"),d=r(Vue.defineComponent({__name:"index",setup(r){const d=e(),m=t(),{query:V,params:f}=m,v={name:{required:!0,trigger:["blur","input"],message:"请输入名称"}},p=Vue.ref(null),h=naive.useMessage(),C=Vue.ref(),w=Vue.ref(!1),N=Vue.ref(!1),x=Vue.reactive({name:"",url:""}),y=Vue.ref(""),g=Vue.ref([]),_=Vue.ref({id:"",name:"",mail:"",secret:""}),b=Vue.reactive({width:220,title:"操作",key:"action",render:e=>Vue.h(a,{style:"button",actions:[{label:"配置",type:"primary",icon:"ic:outline-delete-outline",onClick:k.bind(null,e),ifShow:()=>{for(let t=0;t<g.value.length;t++){const a=g.value[t];if(a.Name==e.Name)return!!a.RawConfig}}}],select:e=>{h.info(`您点击了，${e} 按钮`)}})});function k(e){const t=V.id,a=e.Name;d.push({name:"config",query:{id:t,name:a}})}function T(e){}function j(){C.value.reload()}function R(e){e.preventDefault(),N.value=!0,p.value.validate((e=>{if(e)h.error("请填写完整信息");else if("新建实例"==y.value){const e=x.name;u({name:e}).then((()=>{h.success("新建成功"),setTimeout((()=>{w.value=!1,j()}))}))}else if("更新实例"==y.value){const e=x.name,t=_.value.id,a=_.value.secret;l({name:e,id:t,secret:a}).then((()=>{h.success("更新成功"),setTimeout((()=>{w.value=!1,j()}))}))}N.value=!1}))}return async function(){const e=await n(f.id);g.value=Object.values(e).sort(((e,t)=>e.Name.localeCompare(t.Name)))}(),(e,t)=>{const a=Vue.resolveComponent("n-input"),n=Vue.resolveComponent("n-form-item"),u=Vue.resolveComponent("n-form"),l=Vue.resolveComponent("n-button"),r=Vue.resolveComponent("n-space"),d=Vue.resolveComponent("n-modal"),m=Vue.resolveComponent("n-card");return Vue.openBlock(),Vue.createElementBlock("div",null,[Vue.createVNode(m,{bordered:!1,class:"proCard"},{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(o),{title:"插件列表",columns:Vue.unref(i),dataSource:g.value,"row-key":e=>e.id,pagination:!1,ref_key:"actionRef",ref:C,actionColumn:b,"onUpdate:checkedRowKeys":T,"scroll-x":1090},null,8,["columns","dataSource","row-key","actionColumn"]),Vue.createVNode(d,{show:w.value,"onUpdate:show":t[2]||(t[2]=e=>w.value=e),"show-icon":!1,preset:"dialog",title:y.value},{action:Vue.withCtx((()=>[Vue.createVNode(r,null,{default:Vue.withCtx((()=>[Vue.createVNode(l,{onClick:t[1]||(t[1]=()=>w.value=!1)},{default:Vue.withCtx((()=>[s])),_:1}),Vue.createVNode(l,{type:"info",loading:N.value,onClick:R},{default:Vue.withCtx((()=>[c])),_:1},8,["loading"])])),_:1})])),default:Vue.withCtx((()=>[Vue.createVNode(u,{model:x,rules:v,ref_key:"formRef",ref:p,"label-placement":"left","label-width":80,class:"py-4"},{default:Vue.withCtx((()=>[Vue.createVNode(n,{label:"名称",path:"name"},{default:Vue.withCtx((()=>[Vue.createVNode(a,{placeholder:"请输入实例名称",value:x.name,"onUpdate:value":t[0]||(t[0]=e=>x.name=e)},null,8,["value"])])),_:1})])),_:1},8,["model"])])),_:1},8,["show","title"])])),_:1})])}}}),[["__scopeId","data-v-fa52488a"]]);export{d as default};
