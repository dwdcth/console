import{f as R,q as S}from"./vendor-1e70d1e5.js";import{T as I,B as P}from"./TableAction-a07ea7ef.js";import{_ as U}from"./index-5b101bf5.js";import{B as L,C as $,f as q,u as z}from"./index-7a5dc880.js";import"./index-0ce86e07.js";import{u as M}from"./useProjectSetting-7616714f.js";import"./useDesignSetting-42a1e924.js";function j(a){const l=Vue.ref(!1),d=Vue.ref(null),r=Vue.ref(null);return{loading:l,error:r,result:d,fetchResource:p=>(l.value=!0,a(p).then(m=>{d.value=m}).catch(m=>{r.value=m}).finally(()=>{l.value=!1}))}}function K(){const{loading:a,error:l,result:d,fetchResource:r}=j(L);return{loading:a,error:l,list:d,fetchResource:r}}const O=[{title:"id",key:"id",width:50},{title:"名称",key:"name",width:100},{title:"secret",key:"secret",width:200},{title:"创建时间",key:"createtime",width:200},{title:"状态",key:"online",width:100,render(a){return Vue.h(naive.NTag,{style:{marginRight:"6px"},type:a.online==1?"success":"error",bordered:!1},{default:()=>a.online==1?"在线":"离线"})}}],G=Vue.createTextVNode(" 新建 "),H=Vue.createTextVNode("取消"),J=Vue.createTextVNode("确定"),ue=Vue.defineComponent({__name:"index",setup(a){const l={name:{required:!0,trigger:["blur","input"],message:"请输入名称"}},d=naive.useDialog(),r=Vue.ref(null),s=naive.useMessage(),p=Vue.ref(),m=R(),i=Vue.ref(!1),v=Vue.ref(!1),n=Vue.reactive({name:"",resetSecret:!1}),f=Vue.ref(""),V=Vue.ref({id:"",name:"",mail:"",secret:""}),C=Vue.ref([]),B=Vue.reactive({width:200,title:"操作",key:"action",render(e){return Vue.h(I,{style:"button",actions:[{label:"详情",type:"primary",disabled:e.online!=1,onClick:b.bind(null,e)},{label:"编辑",type:"primary",onClick:y.bind(null,e),ifShow:()=>!0},{label:"删除",type:"error",icon:"ic:outline-delete-outline",onClick:x.bind(null,e),ifShow:()=>!0}],select:t=>{s.info(`您点击了，${t} 按钮`)}})}});function k(){n.name="",f.value="新建实例",i.value=!0}async function h(){const{list:u,error:o,fetchResource:_}=K();await _({pagesize:0,pageno:0}),o.value?s.info(`error--${o.value}`):C.value=u.value.data.list}function w(e){console.log(e)}function g(e){e.preventDefault(),v.value=!0,r.value.validate(t=>{if(t)s.error("请填写完整信息");else if(f.value=="新建实例"){const u=n.name;q({name:u}).then(()=>{s.success("新建成功"),i.value=!1,h()})}else if(f.value=="编辑实例"){const u=V.value.id;z({id:u,...n}).then(()=>{s.success("编辑成功"),i.value=!1,h()})}v.value=!1})}function y(e){n.name=e.name,f.value="编辑实例",i.value=!0,V.value.id=e.id,V.value.name=e.name,V.value.mail=localStorage.getItem("mail")||""}function b(e){const t=e.id,u=m.resolve({name:"instance_dashboard",params:{id:t}});console.log(u.href);const{isSaas:o}=M();o.value?window.open(u.href,"_blank"):location.href=u.href}function x(e){d.info({title:"提示",content:"您确定要删除此实例吗",positiveText:"确定",negativeText:"取消",onPositiveClick:()=>{$({id:e.id}).then(()=>{s.success("删除成功")})},onNegativeClick:()=>{}})}return(e,t)=>{const u=Vue.resolveComponent("n-icon"),o=Vue.resolveComponent("n-button"),_=Vue.resolveComponent("n-input"),F=Vue.resolveComponent("n-form-item"),E=Vue.resolveComponent("n-checkbox"),N=Vue.resolveComponent("n-form"),D=Vue.resolveComponent("n-space"),A=Vue.resolveComponent("n-modal"),T=Vue.resolveComponent("n-card");return Vue.openBlock(),Vue.createElementBlock("div",null,[Vue.createVNode(Vue.unref(U),{onTick:h}),Vue.createVNode(T,{bordered:!1,class:"proCard"},{default:Vue.withCtx(()=>[Vue.createVNode(Vue.unref(P),{columns:Vue.unref(O),dataSource:C.value,"row-key":c=>c.id,pagination:!1,ref_key:"actionRef",ref:p,actionColumn:B,"onUpdate:checkedRowKeys":w,"scroll-x":1090},{tableTitle:Vue.withCtx(()=>[Vue.createVNode(o,{type:"primary",onClick:k},{icon:Vue.withCtx(()=>[Vue.createVNode(u,null,{default:Vue.withCtx(()=>[Vue.createVNode(Vue.unref(S))]),_:1})]),default:Vue.withCtx(()=>[G]),_:1})]),_:1},8,["columns","dataSource","row-key","actionColumn"]),Vue.createVNode(A,{show:i.value,"onUpdate:show":t[3]||(t[3]=c=>i.value=c),"show-icon":!1,preset:"dialog",title:f.value},{action:Vue.withCtx(()=>[Vue.createVNode(D,null,{default:Vue.withCtx(()=>[Vue.createVNode(o,{onClick:t[2]||(t[2]=()=>i.value=!1)},{default:Vue.withCtx(()=>[H]),_:1}),Vue.createVNode(o,{type:"info",loading:v.value,onClick:g},{default:Vue.withCtx(()=>[J]),_:1},8,["loading"])]),_:1})]),default:Vue.withCtx(()=>[Vue.createVNode(N,{model:n,rules:l,ref_key:"formRef",ref:r,"label-placement":"left","label-width":85,class:"py-4"},{default:Vue.withCtx(()=>[Vue.createVNode(F,{label:"名称",path:"name"},{default:Vue.withCtx(()=>[Vue.createVNode(_,{placeholder:"请输入实例名称",value:n.name,"onUpdate:value":t[0]||(t[0]=c=>n.name=c)},null,8,["value"])]),_:1}),f.value=="编辑实例"?(Vue.openBlock(),Vue.createBlock(F,{key:0,label:"重置 secret",path:"resetSecret"},{default:Vue.withCtx(()=>[Vue.createVNode(E,{checked:n.resetSecret,"onUpdate:checked":t[1]||(t[1]=c=>n.resetSecret=c)},null,8,["checked"])]),_:1})):Vue.createCommentVNode("",!0)]),_:1},8,["model"])]),_:1},8,["show","title"])]),_:1})])}}});export{ue as default};
