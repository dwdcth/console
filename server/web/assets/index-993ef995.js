import{k as h,b as u}from"./index-5c1076ad.js";import{T as v,B as g}from"./TableAction-859c4e98.js";import{h as x}from"./vendor-1e70d1e5.js";import"./index-20ae1759.js";import"./useDesignSetting-4e44141c.js";const F=Vue.createTextVNode(" 全文搜索 "),b=Vue.createTextVNode(" 实时跟踪 "),$=Vue.defineComponent({__name:"index",setup(N){const a=Vue.ref(""),l=Vue.ref(""),c=Vue.ref(!0),o=x().params.id,i=Vue.ref([]),d=Vue.computed(()=>a.value?i.value.filter(e=>e.Name.indexOf(a.value)!=-1):i.value);function s(e,t=""){const n={"":"K",K:"M",M:"G",G:null};return e>1024&&n[t]?s(e/1024,n[t]):(e||0).toFixed(2).replace(".00","")+t+"B"}const p=[{title:()=>Vue.h("div",["名称 ",Vue.h(naive.NInput,{placeholder:"按名称过滤",size:"small",onUpdateValue(e){a.value=e}})]),key:"Name",width:100},{title:"大小",width:100,render(e){return Vue.h("text",s(e.Size))}}];h(o).then(e=>{i.value=e||[],c.value=!1});async function V(e){const t=await u(o,!0,!1);window.open(`${t}/logrotate/api/open?file=${encodeURI(e.Name)}`)}async function f(e){const t=await u(o,!0,!1);window.open(`${t}/logrotate/api/download?file=${encodeURI(e.Name)}`)}async function m(){const e=await u(o,!0,!1);window.open(`${e}/logrotate/api/find?query=${l.value}`)}async function w(){const e=await u(o,!0,!1);window.open(`${e}/logrotate/api/tail`)}const _=Vue.reactive({width:220,title:"操作",key:"action",render(e){return Vue.h(v,{style:"button",actions:[{label:"打开",type:"primary",icon:"ic:outline-delete-outline",onClick:V.bind(null,e)},{label:"下载",type:"primary",icon:"ic:outline-delete-outline",onClick:f.bind(null,e)}]})}});return(e,t)=>{const n=Vue.resolveComponent("n-button"),y=Vue.resolveComponent("n-layout-content"),C=Vue.resolveComponent("n-layout");return Vue.openBlock(),Vue.createBlock(C,null,{default:Vue.withCtx(()=>[Vue.createVNode(y,{"content-style":"padding: 24px;"},{default:Vue.withCtx(()=>[Vue.createVNode(Vue.unref(g),{title:"日志文件列表",class:"table",loading:c.value,"row-class-name":"row",columns:p,dataSource:Vue.unref(d),pagination:{simple:!0},actionColumn:_,"row-key":r=>r.Name,"scroll-x":1090},{toolbar:Vue.withCtx(()=>[Vue.createVNode(Vue.unref(naive.NInput),{value:l.value,"onUpdate:value":t[0]||(t[0]=r=>l.value=r)},null,8,["value"]),Vue.createVNode(n,{"attr-type":"button",onClick:m},{default:Vue.withCtx(()=>[F]),_:1}),Vue.createVNode(n,{"attr-type":"button",onClick:w},{default:Vue.withCtx(()=>[b]),_:1})]),_:1},8,["loading","dataSource","actionColumn","row-key"])]),_:1})]),_:1})}}});export{$ as default};
