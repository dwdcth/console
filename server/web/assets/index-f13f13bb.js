import{i as e,g as t,s as o}from"./vendor-2e943313.js";import{T as a,B as n}from"./TableAction-c17a6634.js";import{b as i}from"./index-8caa8cc3.js";import{_ as s}from"./index-dbd922fe.js";import"./useDesignSetting-a0c3f2ea.js";const r=[{title:"StreamPath",key:"Path",width:100},{title:"类型",key:"Type",width:50},{title:"订阅者",key:"Subscribers",width:50},{title:"开始时间",key:"StartTime",width:100},{title:"BPS",key:"BPS",width:100,render(e){const t=e.BPS<<3;return t>1048576?Vue.h("text",(t/1024/1024).toFixed(2)+" mb/s"):t>1024?Vue.h("text",(t/1024).toFixed(2)+" kb/s"):Vue.h("text",t+" b/s")}}],u=s(Vue.defineComponent({__name:"index",setup(s){const u=e(),l=t(),{params:c}=u,d=c.id,h=Vue.ref([]),m=Vue.reactive({width:220,title:"操作",key:"action",fixed:"right",render:e=>Vue.h(a,{style:"button",actions:[{label:"流详情",type:"primary",onClick:w.bind(null,e),ifShow:()=>!0}],dropDownActions:[{label:"http公网",key:"1",text:e.Path,ifShow:()=>!0},{label:"http局域网",key:"2",text:e.Path,ifShow:()=>!0},{label:"https公网",key:"3",text:e.Path,ifShow:()=>!0},{label:"https局域网",key:"4",text:e.Path,ifShow:()=>!0}],select:(e,t)=>{!async function(e,t){const o=t.text,a=await i(d,"2"==e||"4"==e,"3"==e||"4"==e);window.open(`${a}/preview/${o}`,"_blank")}(e,t)}})});async function p(e){const t=JSON.parse(e.data);h.value=t.Streams.sort(((e,t)=>e.Path.localeCompare(t.Path)))}function f(e){}function w(e){const t=e.id,o=e.Path;l.push({name:"instance_stream_detail",query:{id:t,path:o}})}return Vue.onMounted((()=>{const e=new EventSource("/api/summary?m7sid="+d);e.onmessage=p,o((()=>e.close()))})),(e,t)=>{const o=Vue.resolveComponent("n-card");return Vue.openBlock(),Vue.createElementBlock("div",null,[Vue.createVNode(o,{bordered:!1,class:"proCard"},{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(n),{title:"流列表",columns:Vue.unref(r),dataSource:h.value,pagination:!1,"row-key":e=>e.id,actionColumn:m,"onUpdate:checkedRowKeys":f,"scroll-x":1090},null,8,["columns","dataSource","row-key","actionColumn"])])),_:1})])}}}),[["__scopeId","data-v-4ff07e73"]]);export{u as default};
