System.register(["./TableAction-legacy.c2cce013.js","./index-legacy.4f2ba292.js","./vendor-legacy.9d0d38ef.js","./index-legacy.d1f2a5dd.js","./index-legacy.ee50fea4.js","./useDesignSetting-legacy.ecb6b3a9.js"],(function(e,t){"use strict";var a,r,o,l,u,n,s,i,c=document.createElement("style");return c.textContent=".top[data-v-77f1747e]{display:flex}.n-gradient-text[data-v-77f1747e]{font-size:24px}\n",document.head.appendChild(c),{setters:[e=>{a=e.T,r=e.B},e=>{o=e._},e=>{l=e.i},e=>{u=e.h,n=e.i,s=e.j},e=>{i=e._},null],execute:function(){const t=[{title:"开始时间",key:"StartTime",width:160,render:e=>Vue.h(naive.NTime,{time:new Date(e.StartTime),type:"relative"})},{title:"类型",key:"Type",width:100},{title:"推流地址",key:"RemoteURL"},{title:"StreamPath",key:"StreamPath"}],c={class:"top"},d=Vue.createTextVNode("添加推流"),V=Vue.createTextVNode("取消"),m=Vue.createTextVNode("确定");e("default",i(Vue.defineComponent({__name:"index",setup(e){const i=naive.useMessage(),h=Vue.reactive({target:"",streamPath:"",save:!1}),p=Vue.ref(!1),v=Vue.ref([]),f=Vue.ref(!1),{params:g}=l(),y=g.id,w={target:{required:!0,message:"请输入远端流地址",trigger:"blur",validator:(e,t)=>t?!!t.startsWith("rtsp")||!!t.startsWith("rtmp")||(e.message="only support rtsp,rtmp",!1):(e.message="请输入远端流地址",!1)},streamPath:{required:!0,message:"请输入StreamPath",trigger:"blur",validator:(e,t)=>t?1==t.split("/").length?(e.message="StreamPath必须包含/",!1):t.startsWith("/")?(e.message="StreamPath开头不能包含/",!1):!t.endsWith("/")||(e.message="StreamPath结尾不能包含/",!1):(e.message="请输入StreamPath",!1)}};async function C(){v.value=await u(y)}async function x(){p.value=!0;const{target:e,streamPath:t}=Vue.toRaw(h);let a="rtmp";if(e.startsWith("rtsp"))a="rtsp";else{if(!e.startsWith("rtmp"))return i.error("type not support"),void(p.value=!1);a="rtmp"}try{await n(y,a,t,e),p.value=!1,f.value=!1,i.success("成功推到远端流")}catch(r){p.value=!1,i.error(r)}}async function N(e){try{await s(y,e.RemoteURL),i.success("停止推流成功")}catch(t){i.error(t.toString())}}const S=Vue.reactive({title:"操作",key:"action",fixed:"right",width:100,render:e=>Vue.h(a,{style:"button",actions:[{label:"停止推流",type:"error",icon:"ic:outline-delete-outline",onClick:N.bind(null,e),ifShow:()=>!0}]})});return(e,a)=>{const l=Vue.resolveComponent("n-button"),u=Vue.resolveComponent("n-card"),n=Vue.resolveComponent("n-input"),s=Vue.resolveComponent("n-form-item"),i=Vue.resolveComponent("n-switch"),g=Vue.resolveComponent("n-form"),y=Vue.resolveComponent("n-space"),N=Vue.resolveComponent("n-modal");return Vue.openBlock(),Vue.createElementBlock("div",null,[Vue.createElementVNode("div",c,[Vue.createVNode(Vue.unref(o),{onTick:C})]),Vue.createVNode(u,{bordered:!1,class:"proCard"},{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(r),{title:"向远端推流列表",class:"table","row-class-name":"row",columns:Vue.unref(t),dataSource:v.value,pagination:!1,actionColumn:S,"row-key":e=>e.id,"scroll-x":1090},{toolbar:Vue.withCtx((()=>[Vue.createVNode(l,{onClick:a[0]||(a[0]=e=>f.value=!0),type:"primary",round:""},{default:Vue.withCtx((()=>[d])),_:1})])),_:1},8,["columns","dataSource","actionColumn","row-key"])])),_:1}),Vue.createVNode(N,{show:f.value,"onUpdate:show":a[5]||(a[5]=e=>f.value=e),"show-icon":!1,preset:"dialog",title:"向远端服务器推流"},{action:Vue.withCtx((()=>[Vue.createVNode(y,null,{default:Vue.withCtx((()=>[Vue.createVNode(l,{onClick:a[4]||(a[4]=()=>f.value=!1)},{default:Vue.withCtx((()=>[V])),_:1}),Vue.createVNode(l,{type:"info",loading:p.value,onClick:x},{default:Vue.withCtx((()=>[m])),_:1},8,["loading"])])),_:1})])),default:Vue.withCtx((()=>[Vue.createVNode(g,{model:h,rules:w,ref:"formRef","label-placement":"left","label-width":80,class:"py-4"},{default:Vue.withCtx((()=>[Vue.createVNode(s,{label:"远端流地址",path:"target"},{default:Vue.withCtx((()=>[Vue.createVNode(n,{placeholder:"请输入远端服务器推流地址",value:h.target,"onUpdate:value":a[1]||(a[1]=e=>h.target=e)},null,8,["value"])])),_:1}),Vue.createVNode(s,{label:"StreamPath",path:"streamPath"},{default:Vue.withCtx((()=>[Vue.createVNode(n,{placeholder:"请输入StreamPath",value:h.streamPath,"onUpdate:value":a[2]||(a[2]=e=>h.streamPath=e)},null,8,["value"])])),_:1}),Vue.createVNode(s,{label:"重启后恢复",path:"save"},{default:Vue.withCtx((()=>[Vue.createVNode(i,{value:h.save,"onUpdate:value":a[3]||(a[3]=e=>h.save=e)},null,8,["value"])])),_:1})])),_:1},8,["model"])])),_:1},8,["show"])])}}}),[["__scopeId","data-v-77f1747e"]]))}}}));
